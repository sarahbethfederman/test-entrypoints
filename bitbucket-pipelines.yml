image: node:latest

pipelines:
  default:

    - step:
        name: ⬇️ Install
        script:
          - yarn 

        # save installing in the next few steps
        artifacts:
          - "node_modules/**"
          - "**/node_modules/**"

        # save installing on the next time we build
        caches:
          - node

    - parallel:

      - step:
          name: ✅ Lint
          script:
            - yarn run lint
            #- "\"$(yarn bin)/prettier-check\" \"**/*.{json,js,jsx,ts,tsx,md}\""

      - step:
          name: ⚒ Build
          script:
            - yarn run build
          artifacts:
            - "storybook-static/**"

      - step:
          name: 📝 Test
          script:
            - yarn run test

    - step:
        name: 🚀 Deploy
        script:
          - node ./scripts/deploy.js
